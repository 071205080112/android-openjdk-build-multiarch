--- ./common/autoconf/flags.m4    2017-05-14 10:01:38.475911076 +0530
+++ ./common/autoconf/flags.m4    2020-09-16 18:05:25.204273780 +0530
@@ -153,10 +153,17 @@
       AC_DEFUN_ONCE([FLAGS_SETUP_USER_SUPPLIED_FLAGS],
       EXTRA_CFLAGS="$EXTRA_CFLAGS -mthumb -march=armv7-a -mfloat-abi=softfp -mfpu=vfp -fno-short-enums -D__GLIBC__ -D_GNU_SOURCE  -Wno-psabi -fPIE"
       EXTRA_CXXFLAGS="$EXTRA_CXXFLAGS -mthumb -march=armv7-a -mfloat-abi=softfp -mfpu=vfp -DFLOAT_ARCH=-vfp-sflt -fPIE"
       EXTRA_LDFLAGS="$EXTRA_LDFLAGS -Wl,--unresolved-symbols=ignore-all -Wl,--gc-sections -fPIE"
+    elif test "x$OPENJDK_TARGET_CPU" = xarm64 || test "x$OPENJDK_TARGET_CPU" = xaarch64; then
+      EXTRA_CFLAGS="$EXTRA_CFLAGS -march=armv8-a -fno-short-enums -D__GLIBC__ -D_GNU_SOURCE  -Wno-psabi -fPIE"
+      EXTRA_CXXFLAGS="$EXTRA_CXXFLAGS -march=armv8-a -fPIE"
+      EXTRA_LDFLAGS="$EXTRA_LDFLAGS -Wl,--unresolved-symbols=ignore-all -Wl,--gc-sections -fPIE"
+    elif test "x$OPENJDK_TARGET_CPU" = xx86_64; then
+      EXTRA_CFLAGS="$EXTRA_CFLAGS -fno-short-enums -D__GLIBC__ -D_GNU_SOURCE -Wno-psabi -march=x86-64 -msse3 -mstackrealign -mfpmath=sse -fPIE"
+      EXTRA_LDFLAGS="$EXTRA_LDFLAGS -Wl,--unresolved-symbols=ignore-all -Wl,--gc-sections -Wl,-z,nocopyreloc -fPIE"
     else
       EXTRA_CFLAGS="$EXTRA_CFLAGS -fno-short-enums -D__GLIBC__ -D_GNU_SOURCE -Wno-psabi -march=i686 -msse3 -mstackrealign -mfpmath=sse -fPIE"
       EXTRA_LDFLAGS="$EXTRA_LDFLAGS -Wl,--unresolved-symbols=ignore-all -Wl,--gc-sections -Wl,-z,nocopyreloc -fPIE"
     fi
   fi

   # Hotspot needs these set in their legacy form
